{"version":3,"sources":["map.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"map.js","sourcesContent":["/**\n * WIP !\n */\n\nvar legendkeys = [];\n\nvar map = L.map('map', {\n\tscrollWheelZoom: false,\n\tcenter: [14.0, 14.0],\n\tzoom: 6,\n\tattributionControl: false\n});\n\nvar photoLayer = L.photo.cluster().on('click', function(evt) {\n\tvar photo = evt.layer.photo,\n\t\ttemplate = '<img src=\"{url}\"/></a><p>{caption}</p>';\n\n\t// Portrait vs Landscape\n\tvar photoWidth = window.innerWidth / 2; // for landscape photos\n\n\tif (photo.width < photo.height) {\n\t\tphotoWidth = window.innerWidth / 4; // for portrait photos\n\t}\n\tif (window.innerWidth < 500) {\n\t\tphotoWidth = window.innerWidth / 1.25; // landscape on mobile screens\n\n\t\tif (photo.width < photo.height) {\n\t\t\tphotoWidth = window.innerWidth / 1.5; // portrait on mobile screens\n\t\t}\n\t}\n\n\t// console.log(\"original w = \" + photo.width + \" show w = \" + photoWidth);\n\n\tvar photoHeight = photoWidth * (photo.height / photo.width);\n\n\tevt.layer.bindPopup(L.Util.template(template, photo), {\n\t\tclassName: 'leaflet-popup-photo',\n\t\tminWidth: photoWidth // was 500\n\t}).openPopup()\n});\n\nmap.on('popupopen', function(e) {\n\tvar px = map.project(e.popup._latlng); // find the pixel location on the map where the popup anchor is\n\tpx.y -= 200;\n\t// was px.y -= (e.popup._container.clientHeight)/2;\n\t// find the height of the popup container, divide by 2, subtract from the Y axis of marker location\n\t// doesn't work so -200 pixels\n\n\tmap.panTo(map.unproject(px), {\n\t\tanimate: true\n\t}); // pan to new center\n});\n\n\n\nreqwest({\n\turl: '/map/13/49',\n\tsuccess: function(data) {\n\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\tdata[i].thumbnail = data[i].thumbnail;\n\t\t\tdata[i].url = data[i].url;\n\n\t\t\tlegendkeys.push({\n\t\t\t\tcoordinates: [data[i].lat, data[i].lng, 30],\n\t\t\t\ttext: data[i].id,\n\t\t\t\tthumbnail: data[i].thumbnail\n\t\t\t});\n\t\t}\n\n\t\t////////////////////////////////////////\n\t\t// add everything to map\n\t\t//////////////////////////////////////\n\n\t\tvar legend1 = {\n\t\t\ttitle: \"Feautred\",\n\t\t\tdescription: \"Thumbails\",\n\t\t\t//displayPopup: false,\n\t\t\tsections: [{\n\t\t\t\ttitle: 'ALL',\n\t\t\t\tclassName: 'roads',\n\t\t\t\tkeys: legendkeys\n\t\t\t}]\n\t\t};\n\n\t\tvar layer = new\n\t\t\tL.tileLayer(\n\t\t\t'http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png', {\n\t\t\t\tlegend: legend1,\n\t\t\t\topenLegendOnLoad: false,\n\t\t\t\tattribution: '&copy; <a href=\"http://cartodb.com/attributions\">CartoDB</a>'\n\t\t\t});\n\n\n\t\tmap.addLayer(layer);\n\n\t\tvar legendControl = (new L.Control.TileLegend()).addTo(map);\n\n\t\tconsole.log(data);\n\n\t\tphotoLayer.add(data).addTo(map);\n\t\tmap.fitBounds(photoLayer.getBounds());\n\t}\n});\n"],"sourceRoot":"/source/"}